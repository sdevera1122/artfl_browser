<!doctype html>
<head>
    <title>ARTFL Browser</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!--
    <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css" />
    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
    -->
   

    <link rel=stylesheet type=text/css href="/static/typeaheadjs.css">
    <link rel=stylesheet type=text/css href="/static/css/font-awesome.min.css">
    <link href='https://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
    <script type="text/javascript" src="/static/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/static/bootstrap.min.js"></script>
    <script type="text/javascript" src="/static/typeahead.bundle.min.js"></script>

    <script type="text/javascript" src="/static/jquery.tablesorter.min.js"></script>
    <script type="text/javascript" src="/static/jquery.tablesorter.pager.js"></script>
    <link rel=stylesheet type=text/css href="/static/theme.default.css">
    <script type="text/javascript" src="/static/underscore-min.js"></script>

    <link rel=stylesheet type=text/css href="/static/bootstrap.min.css">
    <link rel=stylesheet type=text/css href="/static/style.css">
    <script type="text/javascript" src="/static/d3.v3.min.js"></script>
    <script type="text/javascript" src="https://gabelerner.github.io/canvg/rgbcolor.js"></script>
    <script type="text/javascript" src="https://gabelerner.github.io/canvg/StackBlur.js"></script>
    <script type="text/javascript" src="https://gabelerner.github.io/canvg/canvg.js"></script>

    <script type="text/javascript" src="/static/index.js"></script>
    <script type="text/javascript" src="/static/exac.js"></script>

    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>



    <!--
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-55729303-1', 'auto');
        ga('send', 'pageview');
    </script>-->

    <script type="text/javascript">
        number_of_samples = 60706;
        release_number = 0.3;
        number_of_samples_full = 91796;
        $(document).ready(function() {
            $('.number_samples').html(Number(number_of_samples).toLocaleString('en'));
            $('.number_samples_full').html(Number(number_of_samples_full).toLocaleString('en'));
            $('.release_number').html(Number(release_number).toLocaleString('en'));
        });
        $(function() {
            var bestPictures = new Bloodhound({
              datumTokenizer: Bloodhound.tokenizers.obj.whitespace('value'),
              queryTokenizer: Bloodhound.tokenizers.whitespace,
              remote: '/autocomplete/%QUERY'
            });

            bestPictures.initialize();

            $('.awesomebar').typeahead(
                {
                    autoselect: true,
                },
                {
                    name: 'best-pictures',
                    displayKey: 'value',
                    source: bestPictures.ttAdapter(),
                }
            );
            $('.awesomebar').bind('typeahead:selected', function(obj, datum) {
                window.location.href = '/awesome?query=' + datum.value;
            });
        });

    </script>
</head>
<body>
<nav class="navbar navbar-default " role="navigation" style="background: white; ">
    <div class="container-fluid row " style="margin-right: 0px;">
        <div class="navbar-header col-md-3 col-xs-3">
            <button type="button" class="navbar-toggle pull-right" data-toggle="collapse" data-target="#navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/" ><img src="/static/images/Mergelogo.png" align="left" height="50" width="100"/> <span style="position:absolute; top:40px; left: 100px; color: black; font-weight: bold; float: left; vertical-align:bottom; font-size: 15px; font-family:'Lato' !important;">ARTFL Sequence Analysis </span></a>

        </div>
        <div class="col-md-5 col-xs-5"  style="margin-top: 30px; ">
            <div id="navbar_form_container">
                <form action="/awesome" class="navbar-form" role="search">
                    <div class="form-group" id="navbar-awesomebar">
                        <input type="submit" style="display: none;"/>
                        <input id="navbar-searchbox-input" name="query" class="form-control awesomebar" type="text" placeholder="Gene, transcript, variant, or region"/>
                        <input type="submit" style="position: absolute; left: -9999px"/>
                    </div>
                </form>
            </div>
        </div>
        <div class="col-md-4 col-xs-4" style="margin-top: 30px;"> 
            <div class="nav navbar-nav navbar-right text-right" >
                    <!--<p class="text-muted" style="font-family:'Lato' !important; position:absolute; text-align: right; top:50px; left:85%;">Original source code from <a href="http://exac.broadinstitute.org" target="_blank">ExAC</a> </p>-->
                    <ul class="list-unstyled" style=" font-family:'Lato' !important; ">
                        <li style="font-size: 12px;">Original source code from <a href="http://exac.broadinstitute.org" target="_blank">ExAC</a></li>
                        <li style="font-size: 12px;">Implemented by <span style="color:#245580;" >Sandeep Deverasetty, </span> <a href="https://www.semel.ucla.edu/coppolalab" target="_blank"> Coppola lab </a> </li>
                    </ul>
            </div>
        </div>

    </div>
</nav>







    <!-- Render context vars in JS here -->
    <script type="text/javascript">
        window.gene = {"canonical_transcript": "ENST00000382112", "chrom": "22", "full_gene_name": "DEP domain containing 5", "gene_id": "ENSG00000100150", "gene_name": "DEPDC5", "gene_name_upper": "DEPDC5", "omim_accession": "614191", "omim_description": " DEP DOMAIN-CONTAINING PROTEIN 5; DEPDC5", "other_names": ["KIAA0645", "DEP.5"], "start": 32149945, "stop": 32303013, "strand": "+", "xstart": 22032149945, "xstop": 22032303013};
        window.transcript = {"chrom": "22", "exons": [{"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32150839, "stop": 32150966, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032150839, "xstop": 22032150966}, {"chrom": "22", "feature_type": "UTR", "gene_id": "ENSG00000100150", "start": 32150839, "stop": 32150908, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032150839, "xstop": 22032150908}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32150909, "stop": 32150966, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032150909, "xstop": 22032150966}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32154533, "stop": 32154620, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032154533, "xstop": 22032154620}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32154533, "stop": 32154620, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032154533, "xstop": 22032154620}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32156643, "stop": 32156689, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032156643, "xstop": 22032156689}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32156643, "stop": 32156689, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032156643, "xstop": 22032156689}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32160962, "stop": 32161047, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032160962, "xstop": 22032161047}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32160962, "stop": 32161047, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032160962, "xstop": 22032161047}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32162572, "stop": 32162655, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032162572, "xstop": 22032162655}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32162572, "stop": 32162655, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032162572, "xstop": 22032162655}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32164801, "stop": 32164850, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032164801, "xstop": 22032164850}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32164801, "stop": 32164850, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032164801, "xstop": 22032164850}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32174086, "stop": 32174155, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032174086, "xstop": 22032174155}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32174086, "stop": 32174155, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032174086, "xstop": 22032174155}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32179894, "stop": 32179972, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032179894, "xstop": 22032179972}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32179894, "stop": 32179972, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032179894, "xstop": 22032179972}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32180801, "stop": 32180862, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032180801, "xstop": 22032180862}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32180801, "stop": 32180862, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032180801, "xstop": 22032180862}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32188020, "stop": 32188089, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032188020, "xstop": 22032188089}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32188020, "stop": 32188089, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032188020, "xstop": 22032188089}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32188732, "stop": 32188804, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032188732, "xstop": 22032188804}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32188732, "stop": 32188804, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032188732, "xstop": 22032188804}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32193587, "stop": 32193690, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032193587, "xstop": 22032193690}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32193587, "stop": 32193690, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032193587, "xstop": 22032193690}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32194569, "stop": 32194643, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032194569, "xstop": 22032194643}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32194569, "stop": 32194643, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032194569, "xstop": 22032194643}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32198691, "stop": 32198825, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032198691, "xstop": 22032198825}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32198691, "stop": 32198825, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032198691, "xstop": 22032198825}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32200149, "stop": 32200210, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032200149, "xstop": 22032200210}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32200149, "stop": 32200210, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032200149, "xstop": 22032200210}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32200829, "stop": 32200902, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032200829, "xstop": 22032200902}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32200829, "stop": 32200902, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032200829, "xstop": 22032200902}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32202109, "stop": 32202178, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032202109, "xstop": 22032202178}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32202109, "stop": 32202178, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032202109, "xstop": 22032202178}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32205598, "stop": 32205634, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032205598, "xstop": 22032205634}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32205598, "stop": 32205634, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032205598, "xstop": 22032205634}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32206508, "stop": 32206628, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032206508, "xstop": 22032206628}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32206508, "stop": 32206628, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032206508, "xstop": 22032206628}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32210979, "stop": 32211199, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032210979, "xstop": 22032211199}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32210979, "stop": 32211199, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032210979, "xstop": 22032211199}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32215009, "stop": 32215212, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032215009, "xstop": 22032215212}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32215009, "stop": 32215212, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032215009, "xstop": 22032215212}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32217489, "stop": 32217624, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032217489, "xstop": 22032217624}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32217489, "stop": 32217624, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032217489, "xstop": 22032217624}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32218680, "stop": 32218777, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032218680, "xstop": 22032218777}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32218680, "stop": 32218777, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032218680, "xstop": 22032218777}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32229902, "stop": 32229967, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032229902, "xstop": 22032229967}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32229902, "stop": 32229967, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032229902, "xstop": 22032229967}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32232986, "stop": 32233142, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032232986, "xstop": 22032233142}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32232986, "stop": 32233142, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032232986, "xstop": 22032233142}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32234672, "stop": 32234832, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032234672, "xstop": 22032234832}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32234672, "stop": 32234832, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032234672, "xstop": 22032234832}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32239082, "stop": 32239199, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032239082, "xstop": 22032239199}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32239082, "stop": 32239199, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032239082, "xstop": 22032239199}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32239632, "stop": 32239799, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032239632, "xstop": 22032239799}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32239632, "stop": 32239799, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032239632, "xstop": 22032239799}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32241005, "stop": 32241224, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032241005, "xstop": 22032241224}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32241005, "stop": 32241224, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032241005, "xstop": 22032241224}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32242821, "stop": 32242954, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032242821, "xstop": 22032242954}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32242821, "stop": 32242954, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032242821, "xstop": 22032242954}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32253432, "stop": 32253540, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032253432, "xstop": 22032253540}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32253432, "stop": 32253540, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032253432, "xstop": 22032253540}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32257355, "stop": 32257420, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032257355, "xstop": 22032257420}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32257355, "stop": 32257420, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032257355, "xstop": 22032257420}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32266577, "stop": 32266731, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032266577, "xstop": 22032266731}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32266577, "stop": 32266731, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032266577, "xstop": 22032266731}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32269242, "stop": 32269319, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032269242, "xstop": 22032269319}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32269242, "stop": 32269319, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032269242, "xstop": 22032269319}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32270260, "stop": 32270392, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032270260, "xstop": 22032270392}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32270260, "stop": 32270392, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032270260, "xstop": 22032270392}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32272144, "stop": 32272252, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032272144, "xstop": 22032272252}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32272144, "stop": 32272252, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032272144, "xstop": 22032272252}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32275512, "stop": 32275739, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032275512, "xstop": 22032275739}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32275512, "stop": 32275739, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032275512, "xstop": 22032275739}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32289569, "stop": 32289738, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032289569, "xstop": 22032289738}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32289569, "stop": 32289738, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032289569, "xstop": 22032289738}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32293469, "stop": 32293640, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032293469, "xstop": 22032293640}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32293469, "stop": 32293640, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032293469, "xstop": 22032293640}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32297729, "stop": 32297789, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032297729, "xstop": 22032297789}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32297729, "stop": 32297789, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032297729, "xstop": 22032297789}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32301971, "stop": 32302053, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032301971, "xstop": 22032302053}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32301971, "stop": 32302053, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032301971, "xstop": 22032302053}, {"chrom": "22", "feature_type": "exon", "gene_id": "ENSG00000100150", "start": 32302192, "stop": 32302992, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032302192, "xstop": 22032302992}, {"chrom": "22", "feature_type": "CDS", "gene_id": "ENSG00000100150", "start": 32302192, "stop": 32302481, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032302192, "xstop": 22032302481}, {"chrom": "22", "feature_type": "UTR", "gene_id": "ENSG00000100150", "start": 32302482, "stop": 32302992, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032302482, "xstop": 22032302992}], "gene_id": "ENSG00000100150", "start": 32150839, "stop": 32302992, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032150839, "xstop": 22032302992};
        window.table_variants = [];
        window.variants_in_transcript = [];
        window.transcripts_in_gene = [{"chrom": "22", "gene_id": "ENSG00000100150", "start": 32149945, "stop": 32154611, "strand": "+", "transcript_id": "ENST00000437411", "xstart": 22032149945, "xstop": 22032154611}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32149957, "stop": 32151498, "strand": "+", "transcript_id": "ENST00000469969", "xstart": 22032149957, "xstop": 22032151498}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32149966, "stop": 32174124, "strand": "+", "transcript_id": "ENST00000456178", "xstart": 22032149966, "xstop": 22032174124}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32149966, "stop": 32302737, "strand": "+", "transcript_id": "ENST00000535622", "xstart": 22032149966, "xstop": 22032302737}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150041, "stop": 32230244, "strand": "+", "transcript_id": "ENST00000536766", "xstart": 22032150041, "xstop": 22032230244}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150056, "stop": 32211975, "strand": "+", "transcript_id": "ENST00000400242", "xstart": 22032150056, "xstop": 22032211975}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150070, "stop": 32303001, "strand": "+", "transcript_id": "ENST00000266091", "xstart": 22032150070, "xstop": 22032303001}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150070, "stop": 32303001, "strand": "+", "transcript_id": "ENST00000400249", "xstart": 22032150070, "xstop": 22032303001}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150070, "stop": 32303001, "strand": "+", "transcript_id": "ENST00000400246", "xstart": 22032150070, "xstop": 22032303001}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150070, "stop": 32303001, "strand": "+", "transcript_id": "ENST00000382105", "xstart": 22032150070, "xstop": 22032303001}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150839, "stop": 32302992, "strand": "+", "transcript_id": "ENST00000382112", "xstart": 22032150839, "xstop": 22032302992}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150849, "stop": 32302885, "strand": "+", "transcript_id": "ENST00000382111", "xstart": 22032150849, "xstop": 22032302885}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32150850, "stop": 32303013, "strand": "+", "transcript_id": "ENST00000400248", "xstart": 22032150850, "xstop": 22032303013}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32164839, "stop": 32180245, "strand": "+", "transcript_id": "ENST00000458532", "xstart": 22032164839, "xstop": 22032180245}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32180812, "stop": 32198725, "strand": "+", "transcript_id": "ENST00000469974", "xstart": 22032180812, "xstop": 22032198725}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32188674, "stop": 32200206, "strand": "+", "transcript_id": "ENST00000473802", "xstart": 22032188674, "xstop": 22032200206}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32215053, "stop": 32302985, "strand": "+", "transcript_id": "ENST00000448753", "xstart": 22032215053, "xstop": 22032302985}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32215151, "stop": 32302996, "strand": "+", "transcript_id": "ENST00000433147", "xstart": 22032215151, "xstop": 22032302996}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32229836, "stop": 32234708, "strand": "+", "transcript_id": "ENST00000462414", "xstart": 22032229836, "xstop": 22032234708}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32229853, "stop": 32239649, "strand": "+", "transcript_id": "ENST00000471914", "xstart": 22032229853, "xstop": 22032239649}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32229905, "stop": 32233309, "strand": "+", "transcript_id": "ENST00000494065", "xstart": 22032229905, "xstop": 22032233309}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32232835, "stop": 32239646, "strand": "+", "transcript_id": "ENST00000490731", "xstart": 22032232835, "xstop": 22032239646}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32242926, "stop": 32271430, "strand": "+", "transcript_id": "ENST00000494060", "xstart": 22032242926, "xstop": 22032271430}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32248903, "stop": 32302785, "strand": "+", "transcript_id": "ENST00000539165", "xstart": 22032248903, "xstop": 22032302785}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32269961, "stop": 32275683, "strand": "+", "transcript_id": "ENST00000479261", "xstart": 22032269961, "xstop": 22032275683}, {"chrom": "22", "gene_id": "ENSG00000100150", "start": 32293622, "stop": 32302999, "strand": "+", "transcript_id": "ENST00000497340", "xstart": 22032293622, "xstop": 22032302999}];
        window.coverage_stats = [];
        window.page_name = window.gene.gene_id;
    </script>
    <style>

    </style>
    <script>
        $(document).ready(function() {
            $("#variants_loading").hide();
            $("#variants_table_container").show();
        });
    </script>
    <div class="container-fluid">
        <div class="col-md-10 col-xs-offset-1 col-md-offset-1">
            <h1>Gene: DEPDC5</h1>
            <hr/>
        </div>
        <div class="row">
            <div class="col-md-4 col-xs-10 col-xs-offset-1 col-md-offset-0">
                <dl class="dl-horizontal">
                    
                        <dt>DEPDC5</dt>
                        <dd>DEP domain containing 5</dd>
                    
                    <dt>Number of variants</dt>
                    <dd><span id="number_of_variants"></span> (Including filtered: 0)</dd>


                    <script>
                        filtered_variants = _.filter(window.table_variants, function(d) {
                            return d.filter == 'PASS';
                        });
                        $('#number_of_variants').replaceWith(filtered_variants.length);
                        lof_filtered_variants = _.filter(window.table_variants, function(d) {
                            return d.filter == 'PASS' && d.category == 'lof_variant';
                        });
                        $('#number_of_lof_variants').replaceWith(lof_filtered_variants.length);
                    </script>


                    <dt class="hidden-xs">UCSC Browser</dt>
                    <dd class="hidden-xs">
                        <a href="http://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&position=chr22%3A32149944-32303012" target="_blank">
                            22:32149944-32303012
                            <i class="fa fa-external-link"></i>
                        </a>
                    </dd>
                    <dt class="hidden-xs">GeneCards</dt>
                    <dd class="hidden-xs">
                        <a href="http://www.genecards.org/cgi-bin/carddisp.pl?gene=DEPDC5" target="_blank">
                            DEPDC5
                            <i class="fa fa-external-link"></i>
                        </a>
                    </dd>
                    
                        <dt>OMIM</dt>
                        <dd>
                            <a href="http://omim.org/entry/614191" target="_blank">
                                DEPDC5
                                <i class="fa fa-external-link"></i>
                            </a>
                        </dd>
                    
                    <dt>Other</dt>
                    <dd>
                        <div class="dropdown">
                            <button class="btn btn-default dropdown-toggle" type="button" id="external_ref_dropdown" data-toggle="dropdown">
                                External References
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="external_ref_dropdown">
                                <li role="presentation" class="visible-xs-block">
                                    <a href="http://genome.ucsc.edu/cgi-bin/hgTracks?db=hg19&position=chr22%3A32149944-32303012" target="_blank">
                                        UCSC Browser
                                        <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation" class="visible-xs-block">
                                    <a href="http://www.genecards.org/cgi-bin/carddisp.pl?gene=DEPDC5" target="_blank">
                                        GeneCards
                                        <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" tabindex="-1" href="http://grch37.ensembl.org/Homo_sapiens/Gene/Summary?g=ENSG00000100150" target="_blank">
                                        Ensembl <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" tabindex="-1" href="http://en.wikipedia.org/DEPDC5" target="_blank">
                                        Wikipedia <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" tabindex="-1" href="http://www.ncbi.nlm.nih.gov/pubmed?term=DEPDC5" target="_blank">
                                        PubMed Search <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" tabindex="-1" href="http://www.wikigenes.org/?search=DEPDC5" target="_blank">
                                        Wikigenes <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                                <li role="presentation">
                                    <a role="menuitem" tabindex="-1" href="http://www.gtexportal.org/home/gene/DEPDC5" target="_blank">
                                        GTEx (Expression) <i class="fa fa-external-link"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </dd>
                </dl>
            </div>
            <div class="col-md-1 hidden-xs">
                <div class="dropdown">
                    <button class="btn btn-default dropdown-toggle" type="button" id="transcript_dropdown" data-toggle="dropdown">
                        Transcripts
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="transcript_dropdown">
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000437411" target="_blank">
                                    ENST00000437411
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000469969" target="_blank">
                                    ENST00000469969
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000456178" target="_blank">
                                    ENST00000456178
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000535622" target="_blank">
                                    ENST00000535622
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000536766" target="_blank">
                                    ENST00000536766
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000400242" target="_blank">
                                    ENST00000400242
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000266091" target="_blank">
                                    ENST00000266091
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000400249" target="_blank">
                                    ENST00000400249
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000400246" target="_blank">
                                    ENST00000400246
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000382105" target="_blank">
                                    ENST00000382105
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000382112" target="_blank">
                                    ENST00000382112
                                    
                                        *
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000382111" target="_blank">
                                    ENST00000382111
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000400248" target="_blank">
                                    ENST00000400248
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000458532" target="_blank">
                                    ENST00000458532
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000469974" target="_blank">
                                    ENST00000469974
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000473802" target="_blank">
                                    ENST00000473802
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000448753" target="_blank">
                                    ENST00000448753
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000433147" target="_blank">
                                    ENST00000433147
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000462414" target="_blank">
                                    ENST00000462414
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000471914" target="_blank">
                                    ENST00000471914
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000494065" target="_blank">
                                    ENST00000494065
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000490731" target="_blank">
                                    ENST00000490731
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000494060" target="_blank">
                                    ENST00000494060
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000539165" target="_blank">
                                    ENST00000539165
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000479261" target="_blank">
                                    ENST00000479261
                                    
                                </a>
                            </li>
                        
                            <li role="presentation">
                                <a role="menuitem" tabindex="-1" href="/transcript/ENST00000497340" target="_blank">
                                    ENST00000497340
                                    
                                </a>
                            </li>
                        
                    </ul>
                </div>
            </div>
            <div class="col-md-5 col-md-offset-1">
                
                    <table class="table">
                        <thead>
                            <tr>
                                <th style="padding-top: 4px;">Constraint <br/>from ExAC</th>
                                <th style="padding-top: 4px; width=50%;">Expected <br/>no. variants</th>
                                <th style="padding-top: 4px;" class="tooltip-table-header" data-tooltip="Note that these numbers only consider &#xa; rare (AF < 0.001) variation &#xa; Not all variants in the table &#xa; below may be included">Observed <br/>no. variants in ExAC</th>
                                <th style="padding-top: 4px;" class="tooltip-table-header" data-tooltip="Constraint Metric for each &#xa; category (see FAQ) &#xa; synonymous: Z score &#xa; missense: Z score&#xa; LoF: pLI">Constraint<br/>Metric</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Synonymous</td>
                                <td>253.9</td>
                                <td>250</td>
                                <td>z = 
                                        0.15
                                    
                                </td>
                            </tr>
                            <tr>
                                <td>Missense</td>
                                <td>593.7</td>
                                <td>430</td>
                                <td>z = 
                                    <span class="label label-warning">3.29</span>
                                    
                                </td>
                            </tr>
                            <tr>
                                <td class="tooltip-table-header" data-tooltip="Stop-gained and essential splice site">LoF</td>
                                <td>76.3</td>
                                <td>7</td>
                                <td class="tooltip-table-header" data-tooltip="Probability of LoF intolerance (see FAQ)">
                                        <span class="label label-warning">pLI</span>
                                     =
                                    1.00
                                </td>
                            </tr>
                        </tbody>
                    </table>
                
            </div>
        </div>
        <div class="row">
            <div class="col-md-10 col-md-offset-1">
                <h3>Gene summary</h3>
                <h4>(<span class="hidden-xs">Coverage shown for </span><a href="http://www.ensembl.org/Help/Glossary?id=346" target="_blank">canonical transcript</a>: ENST00000382112)</h4>
                <div class="row">
                    
                        <dl class="dl-horizontal">
    <dt><span style="text-transform:capitalize" id="avg_coverage_type">Mean</span> coverage</dt>
    <dd><span id="avg_coverage"></span></dd>
</dl>
<div id="gene_plot">
    <span class="hidden-xs">
        <label for="display_coverage_metric_group">
            Display:
        </label>
        <span class="btn-group" data-toggle="buttons" id="display_coverage_metric_group">
            <button class="btn btn-primary active display_coverage_metric_buttons"
                    id="display_coverage_overview_button" data-tooltip="Shows all exons">
                <input type="radio">Overview</input>
            </button>
            <button class="btn btn-primary display_coverage_metric_buttons"
                    id="display_coverage_detail_button" data-tooltip="Zoomed in view (can scroll horizontally if needed)">
                <input type="radio">Detail</input>
            </button>
        </span>
        <label>
            <input type="checkbox" id="include_utrs_checkbox" value=""> Include UTRs in plot
        </label>
    </span>
    <span style="float:right;" class="hidden-xs">
    <span style="float: right;">
        <label for="coverage_metric_group">
            Coverage metric:
        </label>
        <span class="btn-group" data-toggle="buttons" id="coverage_metric_group">
            <button class="btn btn-primary active coverage_metric_buttons"
                    id="covered_mean_covmet_button" data-tooltip="Per-base depth of &#xa;coverage. Capped at 100X">
                    <input type="radio">Average</input>
            </button>
            <button class="btn btn-primary coverage_metric_buttons" id="covered_covmet_button"
                data-tooltip="Fraction of individuals with&#xa;coverage above X at each base.&#xa;Use drop down below to select X.">
                <input type="radio">Individuals over X</input>
            </button>
        </span>
    </span>
    <br/>
    <div class="coverage_subcat_selectors" id="over_x_select_container" style="display: none; float:right;">
        <label for="over_x_select">
            Individuals over:
        </label>
        <select id="over_x_select">
            <option>1X</option>
            <option>5X</option>
            <option>10X</option>
            <option>15X</option>
            <option>20X</option>
            <option>25X</option>
            <option selected>30X</option>
            <option>50X</option>
            <option>100X</option>
        </select>
    </div>
    <div class="coverage_subcat_selectors" id="average_select_container" style="float:right;">
        <label for="average_select">
            Metric:
        </label>
        <select id="average_select">
            <option selected>mean</option>
            <option>median</option>
        </select>
    </div>
</span>
    <br/>
    <div id="gene_plot_container_container">
        <div id="loading_coverage">
            Loading coverage...
            <br/><br/>
        </div>
        <span id="gene_plot_axis_container" class="hidden-xs" style="width:50px; display: inline-block;"></span>
        <span id="gene_plot_container" style="overflow-x:scroll; display: inline-block;"></span>
        <a class="btn btn-success" id="coverage_plot_download" target="_blank" download="DEPDC5_coverage">Save coverage plot</a>
        <a class="btn btn-success" id="exon_plot_download" target="_blank" download="DEPDC5_exon">Save exon image</a>
    </div>
</div>
<div id="not_covered" style="display: none;">
    No coverage for this transcript.
</div>
<br/>
<script>
function gene_chart(data, new_data, variant_data, _transcript) {
    var coords = 'pos_coding_noutr';
    var coding_coordinate_params = get_coding_coordinate_params(_transcript, true);
    var chart_width = gene_chart_width;
    var metric = 'mean';

    var exon_x_scale = d3.scale.linear()
        .domain([0, coding_coordinate_params.size])
        .range([0, chart_width]);

    var max_cov = (metric == 'mean' || metric == 'median') ? 300 : 1; //sandeep
    var y = d3.scale.linear()
        .domain([0, max_cov])
        .range([gene_chart_height, 0]);
    
    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left");
    console.log(yAxis)
    var svg = d3.select('#gene_plot_container').append("svg")
        .attr("width", chart_width + gene_chart_margin.left + gene_chart_margin.right)
        .attr("height", gene_chart_height + gene_chart_margin.top + gene_chart_margin.bottom)
        .attr('id', 'inner_svg')
        .attr('class', 'hidden-xs')
        .append("g")
        .attr('id', 'inner_graph')
        .attr("transform", "translate(" + gene_chart_margin.left + "," + gene_chart_margin.top + ")");

    var area = d3.svg.area()
        .x( function(d) {
            return exon_x_scale(d[coords]);
        }).y0( function(d) {
            return gene_chart_height;
        }).y1( function(d) {
            return (metric in d) ? y(d[metric]) : gene_chart_height;
        });

    svg.append("path")
        .datum(new_data)
        .style("fill", "steelblue")
        .attr('class', 'area')
        .attr("d", area);

    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);

    svg.selectAll("circle")
        .data(data)
        .enter()
        .append("circle")
        .attr("cx", function(d) {
            if (d['pos_coding_noutr'] == undefined) {
                return -100;
            } else {
                return exon_x_scale(d[coords]);
            }
        })
        .attr("cy", gene_chart_height + 3)
        .attr('r', 2 );

    d3.select('#gene_plot_container').append("br"); //make sure track_svg is below graph and not to the right of it

    // plot exons
    var svg_outer = d3.select('#gene_plot_container').append("svg")
        .attr("width", chart_width + gene_chart_margin_lower.left + gene_chart_margin_lower.right)
        .attr("height", lower_gene_chart_height)
        .attr('id', 'track_svg')
        .append("g")
        .attr('id', 'track')
        .attr("transform", "translate(" + gene_chart_margin_lower.left + "," + 0 + ")");

    var exon_color = "lightsteelblue";
    svg_outer.append("line")
        .attr("y1", lower_gene_chart_height/2)
        .attr("y2", lower_gene_chart_height/2)
        .attr("x1", 0)
        .attr("x2", exon_x_scale(coding_coordinate_params.size))
        .attr('id', 'boundary_line')
        .attr("stroke-width", 5)
        .attr("stroke", exon_color);

    console.log(_transcript);
    // plot exon rects
    svg_outer.selectAll("bar")
        .data(_transcript.exons)
        .enter()
        .append("rect")
        .attr('class', 'track_bar')
        .style("fill", exon_color)
        .attr("x", function(d, i) { return exon_x_scale(get_coding_coordinate(_transcript, d.start, true)); })
        .attr("y", function(d, i) {
            if (d.feature_type == 'CDS') {
                return 0;
            } else {
                return lower_gene_chart_height/4;
            }
        })


        .attr("width", function(d, i) {
            if (get_coding_coordinate(_transcript, d.start, true) == -100) {
                return exon_x_scale(175);
            }
            return exon_x_scale(d.stop-d.start+1);
        })
        .attr("height", function(d, i) {
            if (d.feature_type == 'CDS') {
                return lower_gene_chart_height;
            } else {
                return lower_gene_chart_height/2;
            }
        });


    var a_s = _transcript.strand == "-"? -1 : 1; //arrow direction
    var a_x = -5;  //arrow position on x-axis
    var a_y = lower_gene_chart_height/2.0; //arrow position on y-axis
    var a_w = 2; //arrow width
    var points = [[a_x+a_s*6, a_y], [a_x+a_s*1, a_y+a_w*3], [a_x+a_s*1, a_y+a_w], [a_x-a_s*9, a_y+a_w],
        [a_x-a_s*9, a_y-a_w], [a_x+a_s*1, a_y-a_w], [a_x+a_s*1, a_y-a_w*3]];
    svg_outer.append("polygon")
            .attr("points", points.join(" "))
            .attr("fill", "steelblue")
            .attr("stroke", "black");

    var bounds = get_af_bounds(variant_data);
    var min_af = bounds[0];
    var max_af = bounds[1];
    var variant_size_scale = d3.scale.log()
        .domain([min_af, max_af])
        //Circle/Ellipse
        .range([2, lower_gene_chart_height/3]);
        //Rectangle
//        .range([lower_gene_chart_height, 2]);

    // show variant category on hover
    var tip = d3.tip().attr('class', 'd3-tip').html(function(d) {
        if (d.category) {
            var csq = d.major_consequence.replace('_variant', '')
                    .replace('_', ' ')
                    .replace('utr', 'UTR')
                    .replace('3 prime', "3'")
                    .replace('5 prime', "5'")
                    .replace('nc ', "non-coding ");
            var output = csq + '<br/>' + d.chrom + ':' + d.pos + ' ' + d.ref + '&#8594;' + d.alt;
            if (d.major_consequence == 'missense_variant' || d.major_consequence == 'synonymous_variant') {
                output += '<br/>' + d.HGVSp;
            }
            output += '<br/>Frequency: ' + d.allele_freq.toPrecision(3);
            return output;
        } else {
            return 'None';
        }
    });
    svg.call(tip);

    // plot variants
    svg_outer.selectAll("bar")
        .data(variant_data)
        .enter()
        .append("a")
        .attr('class', 'track_variant_link')
        .attr("xlink:href", function(d, i) { return "/variant/" + d.chrom + "-" + d.pos + "-" + d.ref + "-" + d.alt; })
        .attr("data-toggle", "tooltip")
        .attr('filter_status', function(d) {
            return d.filter;
        })
        .attr('category', function(d) {
            return d.category;
        })
        .attr('variant_id', function(d) {
            return d.variant_id;
        })
        .on('mouseover', function(d) {
            $('#variant_' + d.variant_id).find('td').addClass('table_hover');
            tip.show(d);
        })
        .on('mouseout', function(d) {
            $('#variant_' + d.variant_id).find('td').removeClass('table_hover');
            tip.hide(d);
        })
        //Circle
//        .append("circle")
        //Ellipse
        .append("ellipse")
        .attr("class", function(d) {
            return "track_variant " + d.category;
        })
        .style("opacity", 0.5)
        .attr("cx",  function(d) {
            if (d['pos_coding_noutr'] == undefined) {
                return -100;
            } else {
                return exon_x_scale(d[coords]);
            }
        })
        .attr("cy", lower_gene_chart_height/2)
        //Circle
//        .attr("r", function(d, i) { return variant_size_scale(d.allele_freq); })
        //Ellipse
        .attr("rx", 2)
        .attr("ry", function(d, i) {
            if (!d.allele_freq) {
                return 0;
            } else {
                return variant_size_scale(d.allele_freq);
            }
        })
        // Workaround for exporting d3 to SVG (other delcaration in style.css).
        .attr('stroke', variant_colors)
        .attr('fill', variant_colors);
        //Rectangle
//        .append("rect")
//        .attr("class", "track_variant")
//        .style("fill", "darkred")
//        .style("opacity", 0.5)
//        .attr("x", function(d, i) {
//            var tx_coord = d.transcript_coordinates[transcript];
//            if (tx_coord == 0) {
//                return -1000;
//            } else {
//                var variant_exon_number = d.vep_annotations[0]['EXON'].split('/')[0] - 1;
//                return exon_x_scale(tx_coord + variant_exon_number*padding);
//            }
//        })
//        .attr("y", function(d, i) { return lower_gene_chart_height/2 - variant_size_scale(d.allele_freq)/2; } )
//        .attr("width", 2)
//        .attr("height", function(d, i) { return variant_size_scale(d.allele_freq); })
//        .attr("rx", 6)
//        .attr("ry", 6);

}

function variant_colors(d) {
    if (d.category == 'lof_variant') {
        return '#cd2932';
    } else if (d.category == 'missense_variant') {
        return '#a96500';
    } else if (d.category == 'synonymous_variant') {
        return '#157e28';
    }
}

function change_coverage_chart(data, new_data, variant_data, _transcript, scale_type, metric, skip_utrs, container) {
    var coords = skip_utrs ? 'pos_coding_noutr' : 'pos_coding';
    var max_cov = (metric == 'mean' || metric == 'median') ? 300 : 1; //sandeep
    var coding_coordinate_params = get_coding_coordinate_params(_transcript, skip_utrs);
    var chart_width;
    if (scale_type == 'overview') {
        chart_width = gene_chart_width;
    } else {
        chart_width = coding_coordinate_params.size*2;
    }

    var exon_x_scale = d3.scale.linear()
        .domain([0, coding_coordinate_params.size])
        .range([0, chart_width]);

    var svg = d3.select(container).select('#inner_svg')
        .attr("width", chart_width + gene_chart_margin.left + gene_chart_margin.right)
        .attr("height", gene_chart_height + gene_chart_margin.top + gene_chart_margin.bottom)
        .select('#inner_graph');

    var y = d3.scale.linear()
        .domain([0, max_cov])
        .range([gene_chart_height, 0]);

    var area = d3.svg.area()
        .x( function(d) {
            return exon_x_scale(d[coords]);
        }).y0( function(d) {
            return gene_chart_height;
        }).y1( function(d) {
            return (metric in d) ? y(d[metric]) : gene_chart_height;
        });


    var path = svg.selectAll("path")
        .datum(new_data)
        .transition()
        .duration(500)
        .attr("d", area)
        .style("fill", "steelblue")
        .attr('class', 'area');

    svg.selectAll("circle")
        .data(data)
        .transition()
        .duration(500)
        .attr("cx", function(d) {
            if (d[coords] == undefined) {
                return -100;
            } else {
                return exon_x_scale(d[coords]);
            }
        });

    // plot exons
    var svg_outer = d3.select(container).select('#track_svg')
        .attr("width", chart_width + gene_chart_margin_lower.left + gene_chart_margin_lower.right)
        .attr("height", lower_gene_chart_height).select('#track');

    svg_outer.select('#boundary_line')
        .attr("x2", exon_x_scale(coding_coordinate_params.size));

    // plot exon rounded rects
    svg_outer.selectAll("rect")
        .data(_transcript.exons)
        .transition()
        .duration(500)
        .attr("x", function(d, i) { return exon_x_scale(get_coding_coordinate(_transcript, d.start, skip_utrs)); })
        .attr("width", function(d, i) {
            if (get_coding_coordinate(_transcript, d.start, skip_utrs) == -100) {
                return exon_x_scale(175);
            }
            return exon_x_scale(d.stop-d.start+1);
        })
        .attr("height", function(d, i) {
            if (d.feature_type == 'CDS') {
                return lower_gene_chart_height;
            } else {
                return lower_gene_chart_height/2;
            }
        });

    // plot variants
    svg_outer.selectAll("a")
        .data(variant_data)
        .transition()
        .duration(500)
        .selectAll('ellipse')
        .attr("cx", function(d) {
            if (d[coords] == undefined) {
                return -100;
            } else {
                return exon_x_scale(d[coords]);
            }
        });

    var yAxis = d3.svg.axis()
        .scale(y)
        .orient("left");

    svg.select(".y.axis")
        .transition()
        .duration(200)
        .call(yAxis);
}

function create_new_data(data, coords) {
    var data_object = {};
    $.each(data, function(i, d) {
        data_object[d[coords]] = d;
    });
    var new_data = [];
    var max_coord = d3.max(data, function(d) { return d[coords] });
    for (var i = d3.min(data, function(d) { return d[coords] }); i < max_coord; i++) {
        var x = {'has_coverage': false};
        x[coords] = i;
        //Check the previous base to see if this is the beginning of an exon

        if (i in data_object && !(i-1 in data_object)) {
            new_data.push(x);
        }
        //Check the previous base to see if this is the end of an exon

        if (!(i in data_object) && i-1 in data_object) {
            x[coords] = i-1;
            new_data.push(x);
        }
        if (i in data_object) {
            new_data.push(data_object[i]);
        } else {
            new_data.push(x);
        }
    }
    return new_data;
}

function coverage_sum(key) {
    var total = 0;
    $.map(window.coverage_stats, function(entry) {
        total += entry[key];
    });
    return (total/window.coverage_stats.length).toPrecision(4);
}

function refresh_links() {
    $("#coverage_plot_download").attr('href', set_plot_image('gene_plot_container', 0));
    $("#exon_plot_download").attr('href', set_plot_image('gene_plot_container', 1));
}

$(document).ready(function() {
    if ($(window).width() < 768) {
        $('#gene_plot_container').css('width', $(window).width() + "px");
    } else {
        $('#gene_plot_container').css('width', $(window).width()*10/12 + "px");
    }
    precalc_coding_coordinates(window.transcript, window.coverage_stats, 'pos');
    precalc_coding_coordinates(window.transcript, window.variants_in_transcript, 'pos');

    // only show variants that have a coding coordinate
    window.variants_in_transcript = _.filter(window.variants_in_transcript, function(variant) {
        return variant.pos_coding != undefined;
    });

    // only show coding rects that have a coding coordinate
    window.coverage_stats = _.filter(window.coverage_stats, function(d) {
        return d.pos_coding != undefined;
    });
    $('#avg_coverage').html(coverage_sum('mean'));
    $('#avg_coverage_x').html(coverage_sum('30')*100 + '%');

    var new_data = create_new_data(window.coverage_stats, 'pos_coding');
    var new_data_skip_utr = create_new_data(window.coverage_stats, 'pos_coding_noutr');
    if (window.coverage_stats != null) {
        gene_chart(window.coverage_stats, new_data_skip_utr, window.variants_in_transcript, window.transcript);
        if (window.variants_in_transcript.length) {
            update_variants();
        }
        $('#loading_coverage').hide();
    } else {
        $('#gene_plot').hide();
        $('#not_covered').show();
    }
    // Change coverage plot
    $('.coverage_metric_buttons').change(function () {
        var v = $(this).attr('id').replace('_covmet_button', '');
        $('.coverage_subcat_selectors').hide();
        if (v == 'covered') {
            $('#over_x_select_container').show();
            v = $('#over_x_select').val().replace('X', '');
        } else {
            $('#average_select_container').show();
            v = $("#average_select").val();
        }
        var detail = $('.display_coverage_metric_buttons.active').attr('id').replace('display_coverage_', '').replace('_button', '');
        var include_utrs = $('#include_utrs_checkbox').is(':checked');
        var plot_data = include_utrs ? new_data : new_data_skip_utr;
        change_coverage_chart(window.coverage_stats, plot_data, window.variants_in_transcript, window.transcript, detail, v, !include_utrs, '#gene_plot_container');
        refresh_links();
    });
    $('#over_x_select').change(function () {
        var detail = $('.display_coverage_metric_buttons.active').attr('id').replace('display_coverage_', '').replace('_button', '');
        var include_utrs = $('#include_utrs_checkbox').is(':checked');
        var plot_data = include_utrs ? new_data : new_data_skip_utr;
        $('#avg_coverage_type_x').html($(this).val());
        $('#avg_coverage_x').html(coverage_sum($(this).val().replace('X', ''))*100 + '%');
        change_coverage_chart(window.coverage_stats, plot_data, window.variants_in_transcript, window.transcript, detail, $(this).val().replace('X', ''), !include_utrs, '#gene_plot_container');
        refresh_links();
    });
    $('#average_select').change(function () {
        var detail = $('.display_coverage_metric_buttons.active').attr('id').replace('display_coverage_', '').replace('_button', '');
        var include_utrs = $('#include_utrs_checkbox').is(':checked');
        var plot_data = include_utrs ? new_data : new_data_skip_utr;
        $('#avg_coverage_type').html($(this).val());
        $('#avg_coverage').html(coverage_sum($(this).val()));
        change_coverage_chart(window.coverage_stats, plot_data, window.variants_in_transcript, window.transcript, detail, $(this).val(), !include_utrs, '#gene_plot_container');
        refresh_links();
    });
    $('#include_utrs_checkbox').change(function () {
        setTimeout(function() {
            var detail = $('.display_coverage_metric_buttons.active').attr('id').replace('display_coverage_', '').replace('_button', '');
            var v = $('.coverage_metric_buttons.active').attr('id').replace('_covmet_button', '');
            v = (v == 'covered') ? $('#over_x_select').val().replace('X', '') : $("#average_select").val();
            var include_utrs = $('#include_utrs_checkbox').is(':checked');
            var plot_data = include_utrs ? new_data : new_data_skip_utr;
            change_coverage_chart(window.coverage_stats, plot_data, window.variants_in_transcript, window.transcript, detail, v, !include_utrs, '#gene_plot_container');
            refresh_links();
        }, 10);
    });

// Change exon diagram
    $('#inverted_checkbox').change(function () {
        setTimeout(function () {
            var v = $('#inverted_checkbox').is(':checked');
            change_track_chart_variant_size(window.variants_in_transcript, v, '#gene_plot_container');
            refresh_links();
        }, 10);
    });

    $('.consequence_display_buttons, #filtered_checkbox').change(function () {
        setTimeout(function() {
            update_variants();
            refresh_links();
        }, 10);
    });

    $('.display_coverage_metric_buttons').change(function () {
        var detail = $(this).attr('id').replace('display_coverage_', '').replace('_button', '');
        var v = $('.coverage_metric_buttons.active').attr('id').replace('_covmet_button', '');
        if (v == 'covered') {
            $('#over_x_select_container').show();
            v = $('#over_x_select').val().replace('X', '');
        } else {
            $('#average_select_container').show();
            v = $("#average_select").val();
        }
        var include_utrs = $('#include_utrs_checkbox').is(':checked');
        var plot_data = include_utrs ? new_data : new_data_skip_utr;
        change_coverage_chart(window.coverage_stats, plot_data, window.variants_in_transcript, window.transcript, detail, v, !include_utrs, '#gene_plot_container');
        refresh_links();
    });
    refresh_links();
});
</script>
                    
                </div>
                <div class="row">
                    
                        No variants in this gene.
                    
                </div>
            </div>
        </div>
    </div>

</body>














